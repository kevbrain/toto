<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
		"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:h="http://java.sun.com/jsf/html"
	  xmlns:p="http://primefaces.org/ui"
	  xmlns:ui="http://java.sun.com/jsf/facelets"
	  xmlns:f="http://java.sun.com/jsf/core"
>

<h:head>
		<link rel="stylesheet" href="primefaces-smoothness/primeicons.css"/>
		<h:outputStylesheet name="primefaces-smoothness/primeicons.css" />
</h:head>

<h:body style="margin-left:10px">	
	
	<script type="text/javascript">
		function handleDrop(event, ui) {
			var droppredKey = ui.draggable;
			
		}
	</script>
    
	<p:panel id="panelApp">
			<f:facet name="header">
				<h:panelGrid columns="3">
					<p:graphicImage name="LOGO_ITS4U_Group_Interstate_COLOR.png"  style="background: transparent;width:200px;margin-right:20px;"/>
					
					<p:outputLabel value="#{viewInitializerBean.titleApp}"   style="width:100%;text-align: center;font-size: 40px;color:#003b50"></p:outputLabel>
					
				</h:panelGrid>			
			</f:facet>
   	<h:form id="form" prependId="false">
   		<p:growl id="growl" showDetail="true" />
   			<center>	   		
	   		<h:panelGrid columns="3" >
	   			<p:commandButton   icon="fa fa-fw fa-chevron-left" actionListener="#{viewInitializerBean.previousStep}"  update="@form"  style="margin:10px;background:#003b50;color:white" immediate="true" />
	   			<p:steps activeIndex="#{viewInitializerBean.activeIndex}"  >
	   				<p:menuitem value="Setup" style="width:150px;"/>	   				
	   				<p:menuitem value="PlaceHolders" style="width:150px;"/>
	   				<p:menuitem value="Secrets/CM" style="width:150px;"/>
	   				<p:menuitem value="Volumes" style="width:150px;"/>
	   				<p:menuitem value="Exposition" style="width:150px;"/>
	   				<p:menuitem value="Resources" style="width:150px;"/>
	   				<p:menuitem value="mvn Project" style="width:150px;"/>
	   			</p:steps>
	   			<p:commandButton   icon="fa fa-fw fa-chevron-right" actionListener="#{viewInitializerBean.nextStep}"  update="@form" style="margin:10px;background:#003b50;color:white" />
	   		</h:panelGrid>
	   		</center>
   			<div style="position:relative;margin:auto;text-align:center;">		    				    		
				    	<p:commandButton value="Reset Configuration"  actionListener="#{viewInitializerBean.reset}" update="@form" style="margin:10px;background:#003b50;color:white" />				    					    					    	
				    	<p:commandButton value="Apply and create Project"  actionListener="#{viewInitializerBean.createPlaceHolderProject}" 
				    		onclick="PF('dlg0').show()" oncomplete="PF('dlg0').hide();PF('dlgLog').show();"
				    		update="growl" style="margin:10px;background:#003b50;color:white" disabled="#{viewInitializerBean.disablePublish}"/>
				    	<p:commandButton value="Logs" onclick="PF('dlg1').show()"/>
				    	<p:commandButton value="Report" oncomplete="PF('dlgReportExecution').show()" update="fgiturl,fplaceholderurl,fcodereadyurl,focpurl"/>
			    </div>
   			
   			<br/> 
   			
   			<p:panel id="MavenProject" rendered="#{viewInitializerBean.activeIndex==6}" style="position:relative;margin:auto;" >
   			 
  					<p:tree value="#{mavenInitializerBean.root}" var="doc" selectionMode="single" selection="#{mavenInitializerBean.selectedNode}" style="width:100%;">
  						<p:ajax event="select"  listener="#{mavenInitializerBean.onNodeSelect}" oncomplete="PF('dlg1').show()" update=":dlg1"/>
  						<p:treeNode expandedIcon="fa fa-fw fa-folder-open" collapsedIcon="fa fa-fw fa-folder">
		                <h:outputText value="#{doc.name}"/>
		            </p:treeNode>
		            <p:treeNode type="Text" icon="fa fa-fw fa-file-alt">
		                <h:outputText value="#{doc.name}"/>
		            </p:treeNode>
  					</p:tree>
				    				
   			</p:panel>
   			
   			<p:fieldset id="msconfig" legend="Application Metadata" rendered="#{viewInitializerBean.activeIndex==0}">
   				
			    <p:tabView>
			    	<p:tab title="Project Metadata">
			    		<h:panelGrid columns="5">	 
			    	
						    		<h:panelGrid columns="2">	   			
							   			<h:outputText value="Application Name"/>
							   			<p:inputText value="#{viewInitializerBean.appName}"   style="width:400px;" >
							   				<p:ajax event="change" listener="#{viewInitializerBean.newApp(viewInitializerBean.appName)}" update="@form" />
							   			</p:inputText>								   						
							   			
							   			<h:outputText value="Environments"/>
							   			<h:panelGrid>
							   				<h:panelGrid columns="2">
								   				<p:selectBooleanCheckbox value="#{ocpInitializerBean.namespaces['dev'].activate}" itemLabel="DEV" disabled="true">
								   					<p:ajax event="change" listener="#{viewInitializerBean.handleEnv('dev')}" immediate="true" update="@form"/>
								   				</p:selectBooleanCheckbox>
								   				<p:inputText value="#{ocpInitializerBean.namespaces['dev'].name}" style="width:400px;"/>
							   				</h:panelGrid>
							   				<h:panelGrid columns="2">
								   				<p:selectBooleanCheckbox value="#{ocpInitializerBean.namespaces['tst'].activate}" itemLabel="TST">
								   					<p:ajax event="change" listener="#{viewInitializerBean.handleEnv('tst')}" immediate="true" update="@form"/>
								   				</p:selectBooleanCheckbox>
								   				<p:inputText value="#{ocpInitializerBean.namespaces['tst'].name}" style="width:400px;"/>
								   			</h:panelGrid>
								   			<h:panelGrid columns="2">
								   				<p:selectBooleanCheckbox value="#{ocpInitializerBean.namespaces['int'].activate}" itemLabel="INT">
								   					<p:ajax event="change" listener="#{viewInitializerBean.handleEnv('int')}" immediate="true" update="@form"/>
								   				</p:selectBooleanCheckbox>
								   				<p:inputText value="#{ocpInitializerBean.namespaces['int'].name}" style="width:400px;"/>
								   			</h:panelGrid>
							   			
							   			</h:panelGrid>
							   			
							   			
							   			<h:outputText value="Group" />
							   			<p:inputText value="#{mavenInitializerBean.group}"  style="width:500px;" >
							   				<p:ajax event="change" update="@form" />
							   			</p:inputText>	
							   			
							   			<h:outputText value="Artifact" />
							   			<p:inputText value="#{mavenInitializerBean.artifact}"  style="width:500px;"/>
							   			
							   			<h:outputText value="Description"/>
							   			<p:inputText value="#{mavenInitializerBean.description}"  style="width:500px;"/>
							   				   			
							   			<h:outputText value="Java"/>
							   			<p:selectOneButton value="#{mavenInitializerBean.java}">
								            <f:selectItem itemLabel="16" itemValue="16"/>
								            <f:selectItem itemLabel="11" itemValue="11"/>
								            <f:selectItem itemLabel="8" itemValue="8"/>
								        </p:selectOneButton>
								        
								     
					    			</h:panelGrid>
					    			<p:spacer height="10" width="100"></p:spacer>
					    			<p:panel header="Add Maven dependencies :" >
					    				
						    			<h:panelGrid columns="1">
							    			<p:selectBooleanCheckbox value="#{mavenInitializerBean.lombok}" itemLabel="Lombok"/>
							    			<p:selectBooleanCheckbox value="#{mavenInitializerBean.actuator}" itemLabel="Actuator"/>
							    			<p:selectBooleanCheckbox value="#{mavenInitializerBean.freemarker}" itemLabel="FreeMarker"/>
							    			<p:selectBooleanCheckbox value="#{mavenInitializerBean.sonar}" itemLabel="Sonar"/>
							    			<p:selectBooleanCheckbox value="#{mavenInitializerBean.web}" itemLabel="Web-starter"/>
							    			<p:selectBooleanCheckbox value="#{mavenInitializerBean.apiRest}" itemLabel="Api Rest"/>
							    			<p:selectBooleanCheckbox value="#{mavenInitializerBean.springIntegration}" itemLabel="Spring-Integration"/>
							    			<p:selectBooleanCheckbox value="#{mavenInitializerBean.joinfaces}" itemLabel="JoinFaces"/>
				    			
				    					</h:panelGrid>
				    				</p:panel>
				    				<p:spacer height="10" width="100"></p:spacer>
				    				
			    					
					    </h:panelGrid>
					    	
			    	</p:tab>
			    	
			    	<p:tab title="GIT">
			    		<h:panelGrid columns="5">
			    			<h:outputText value="GIT url"/>
				   			<p:inputText value="#{gitInitializerBean.gitUrl}"  style="width:500px;"/>	
				   			<p:spacer height="10" width="10"></p:spacer>
				   			<h:outputText value="GIT user"/>
				   			<p:inputText value="#{gitInitializerBean.gitUser}"  style="width:200px;"/>		
				   			
							
							<h:outputText value="GIT Revision"/>
				   			<p:inputText value="#{gitInitializerBean.gitRevision}"  style="width:200px;"/>		
				   			<p:spacer height="10" width="10"></p:spacer>
				   			<h:outputText value="GIT Token"/>
				   			<p:password value="#{gitInitializerBean.gitPassword}" toggleMask="true" redisplay="true" style="width:400px;">   	
				   				<p:ajax event="change" listener="#{viewInitializerBean.refreshAllconf}" update="@form" />
				   			</p:password>
				   								
							<h:outputText value="GIT SubDirectory"/>
				   			<p:inputText value="#{gitInitializerBean.gitSubDirectory}"  style="width:400px;"/>		   				
		   					
			    		</h:panelGrid>
			    		
		    	
			    		
			    	</p:tab>
			    	<p:tab title="OCP">
			    			<h:panelGrid columns="2">	   			
			    			
							   			<h:outputText value="Server :"/>
							   			<p:inputText value="#{ocpInitializerBean.server}"   style="width:600px;" >
							   				<p:ajax event="change"  update="@form" />
							   			</p:inputText>		
							   			<h:outputText value="Token :"/>
							   			<p:inputText value="#{ocpInitializerBean.token}"   style="width:600px;" >
							   				<p:ajax event="change" listener="#{viewInitializerBean.refreshAllconf}" update="@form" />
							   			</p:inputText>							
							   			<h:outputText value="NameSpace DEV :" rendered="#{ocpInitializerBean.namespaces['dev'].activate}"/>
							   			<h:outputText  value="#{ocpInitializerBean.namespaces['dev'].name}"   style="width:400px;" rendered="#{ocpInitializerBean.namespaces['dev'].activate}"/>
							   					
							   			
							   			<h:outputText value="NameSpace TST :" rendered="#{ocpInitializerBean.namespaces['tst'].activate}"/>
							   			<h:outputText value="#{ocpInitializerBean.namespaces['tst'].name}"   style="width:400px;" rendered="#{ocpInitializerBean.namespaces['tst'].activate}"/>
							   				
							   			
							   			<h:outputText value="NameSpace INT :" rendered="#{ocpInitializerBean.namespaces['int'].activate}"/>
							   			<h:outputText value="#{ocpInitializerBean.namespaces['int'].name}"   style="width:400px;" rendered="#{ocpInitializerBean.namespaces['int'].activate}" />
							   				
							   			
							   			<h:outputText value="Registry :"/>
							   			<p:inputText value="#{ocpInitializerBean.registry}"   style="width:800px;" >
							   				<p:ajax event="change"  update="@form" />
							   			</p:inputText>
							</h:panelGrid>
							
							<p:commandButton value="Test Connection" actionListener="#{ocpInitializerBean.testConnection()}" />
			    	</p:tab>
			    	<p:tab title="ARGO">
			    			<h:panelGrid columns="5">	 
			    						<h:outputText value="Server :"/>
							   			<p:inputText value="#{argoInitializerBean.argoServer}"   style="width:600px;" >
							   				<p:ajax event="change"  update="@form" />
							   			</p:inputText>	
							   			<p:spacer height="10" width="10"></p:spacer>
							   			<h:outputText value="Repo GitOps url :"/>
							   			<p:inputText value="#{argoInitializerBean.gitOpsRepo}"   style="width:600px;" >
							   				<p:ajax event="change"  update="@form" />
							   			</p:inputText>	
							   			
							   			<h:outputText value="user :"/>
							   			<p:inputText value="#{argoInitializerBean.argoUser}"   style="width:600px;" >
							   				<p:ajax event="change"  update="@form" />
							   			</p:inputText>	
							   			<p:spacer height="10" width="10"></p:spacer>
							   			<h:outputText value="Repo GitApps url :"/>
							   			<p:inputText value="#{argoInitializerBean.gitOpsAppsRepo}"   style="width:600px;" >
							   				<p:ajax event="change"  update="@form" />
							   			</p:inputText>
							   			
							   			<h:outputText value="Password :"/>
							   			<p:password value="#{argoInitializerBean.argoPassword}" toggleMask="true" redisplay="true" style="width:400px;">   	
				   							<p:ajax event="change" update="@form" />
				   						</p:password>
				   						<p:spacer height="10" width="10"></p:spacer>
							   			<h:outputText value="Argo project :"/>
							   			<p:inputText value="#{argoInitializerBean.argoProj}"   style="width:600px;" >
							   				<p:ajax event="change"  update="@form" />
							   			</p:inputText>
			    			</h:panelGrid>
			    	</p:tab>
			    	<p:tab title="CODEREADY">
			    		<h:panelGrid columns="5">
			    			<h:outputText value="Worspace user"/>
				   			<p:inputText value="#{codeReadyWorspaceManagerBean.user}"  style="width:500px;"/>	
				   			<p:spacer height="10" width="10"></p:spacer>
				   			<h:outputText value="user password"/>
				   			<p:password value="#{codeReadyWorspaceManagerBean.userPassword}" toggleMask="true" redisplay="true" style="width:300px;"/>	
				   			
				   			<h:outputText value="Client Id"/>
				   			<p:inputText value="#{codeReadyWorspaceManagerBean.clientId}"  style="width:500px;"/>	
				   			<p:spacer height="10" width="10"></p:spacer>
				   			<h:outputText value="Client Secret"/>
				   			<p:password value="#{codeReadyWorspaceManagerBean.clientId}" toggleMask="true" redisplay="true" style="width:400px;"/>
				   			
				   			<h:outputText value="Workspace Base Url"/>
				   			<p:inputText value="#{codeReadyWorspaceManagerBean.workspaceBaseUrl}"  style="width:500px;"/>	
				   			<p:spacer height="10" width="10"></p:spacer>
				   			<h:outputText value="OAuth Provider Url"/>
				   			<p:inputText value="#{codeReadyWorspaceManagerBean.authProviderUrl}" style="width:500px;"/>
				   		</h:panelGrid>
			    	</p:tab>
			    </p:tabView>
	   				    	
		    </p:fieldset>
		   
		    <br/>
		    <p:spacer height="10" width="10"></p:spacer>
		    <h:outputText value="Drop below the files you want to analyse in order to find placeholders" rendered="#{viewInitializerBean.activeIndex==0}"/>  
   			<p:fileUpload value="#{viewInitializerBean.file}" mode="advanced" id="fileuploader" dragDropSupport="true"
   				rendered="#{viewInitializerBean.activeIndex==0}" update="@form"
   				listener="#{viewInitializerBean.fileUploadListener}"></p:fileUpload>
   				
   			<p:dataTable value="#{viewInitializerBean.filesForAnalyse}" var="entry" rendered="#{viewInitializerBean.activeIndex==0}" > 
									<p:column  headerText="File Name">	
							        		<h:outputText value="#{entry.fileName}"/>
									</p:column>		
									<p:column  headerText="Type">	
							        	<p:selectOneMenu value="#{entry.type}" >
							        		<f:selectItem itemLabel="Choose a type" itemValue="#{null}"/>
											<f:selectItem itemLabel="Properties file" itemValue="Properties file"/>
											<f:selectItem itemLabel="Script file" itemValue="Script file"/>											
										</p:selectOneMenu>
									</p:column>								
							</p:dataTable>

		    <p:outputPanel id="buttonPanel" rendered="#{viewInitializerBean.activeIndex==1}">
				<div style="position:relative;margin:auto;text-align:center;">
			    				    		

				    	<p:commandButton value="Add Config Map"  actionListener="#{viewInitializerBean.addConfigMap}" update="@form" style="margin:10px;background:#003b50;color:white" />
				    	<p:commandButton value="Add Secret" actionListener="#{viewInitializerBean.addSecret}"  update="@form" style="margin:10px;background:#003b50;color:white" />
				    	
			    </div>
			</p:outputPanel>
	        
	        <p:outputPanel id="keyConfigPanel" rendered="#{viewInitializerBean.activeIndex==1}">
		        <table>
		        	<tr>
		        		<!-- KEY LIST -->
			        	<td style="width:600px">
			        		<p:fieldset id="keyList" legend="PlaceHolders Detected" >
			        			<p:outputPanel id="dropAreakeySet">
							        <p:dataTable id="datakeys" var="key" value="#{viewInitializerBean.availableKeys}"								        	
							        	selection="#{viewInitializerBean.selectedKeys}" rowKey="#{key}"			        	
							        	paginator="true" rows="20" paginatorPosition="bottom"> 
							        	<p:column selectionMode="multiple" style="width:16px;text-align:center" />
							        	<p:column style="width:20px">
							        		<h:outputText id="dragIcon" class="fa fa-fw fa-crosshairs"/>
							        		<p:draggable for="dragIcon" revert="true" helper="clone"></p:draggable>
							        	</p:column>
							        	<p:column headerText="Keys" filterBy="#{key}" filterMatchMode="contains" sortBy="#{key}"> 
							        		<h:outputText value="#{key}"/>
							        	</p:column>
					        		</p:dataTable>
					        	</p:outputPanel>
				        	</p:fieldset>				        	
			        	</td>			
			        				        				        	        
		        		<td>
		        			<!-- VARIABLES ENVIRONMENT -->
		        			<br/>
		        				<p:repeat var="container" value="#{viewInitializerBean.containers}" id="container">
					        			<p:fieldset  id="envVar" legend="Container #{container.containerID} Env Variables" 
					        				toggleable="true" toggleSpeed="500"
					        				>
						        			<h:panelGrid columns="3">
						        				
						        				<h:panelGroup>	
						        					<div>	
						        						<p:commandLink actionListener="#{viewInitializerBean.removeContainer(container.containerID)}" update="@form">
						        							<i class="fa fa-fw fa-remove" style="float:right" />
						        						</p:commandLink>
						        					</div>
								        			<h:panelGrid columns="5">
											   			<h:outputText value="Name:"/>
											   			{AppName}<b>#{container.name}</b>
											   			<p:spacer width="50"/>
											   			
											   			<h:outputText value="Image :"/>
											   			<h:outputText value="{{ocp-cluster.registry}}/{{ocp-namespace}}/{appName}:@project.version"/>
											   			</h:panelGrid>
				    								<h:panelGrid columns="3">
					    								<p:commandButton  icon="fa fa-fw fa-chevron-left"
								        							actionListener="#{viewInitializerBean.moveSelectedEnVarKeysToDataKey(container.containerID)}" update="@form" />
								        				<p:commandButton  icon="fa fa-fw fa-chevron-right"
								        							actionListener="#{viewInitializerBean.moveSelectedKeysToEnVar(container.containerID)}" update="@form" />
								        				
									        			 <p:outputPanel id="dropAreaEnVar_#{container.containerID}"> 
											        			<p:dataTable id="selectedForEnVar_#{container.containerID}" var="key"											        				
											        				 value="#{container.envVariables}" >
												        			<p:column  style="width:16px;text-align:center" >	
												        				 <p:selectBooleanCheckbox>
												        				 	<p:ajax event="change" listener="#{viewInitializerBean.selectEnvVar(container.containerID,key)}"  immediate="true"/>
												        				 </p:selectBooleanCheckbox>
												        			</p:column>
											        				
											        				<p:column headerText="OCP Key">
													        			<h:outputText value="#{key.key}"/>
													        		</p:column>												        	
											        			</p:dataTable>										        			
 										        		</p:outputPanel> 
								        			</h:panelGrid>
								        			
									        	</h:panelGroup>
									        </h:panelGrid>
						        		</p:fieldset>
					        			<br/>					        			
			        			</p:repeat>
			        			
			        		<p:repeat var="container" value="#{viewInitializerBean.containers}">
			        				<p:droppable for="container:#{container.containerID}:envVar" tolerance="touch" 
			        							 datasource="datakeys" onDrop="handleDrop">
						        			<p:ajax listener="#{viewInitializerBean.onKeyDropToEnVar}" update="@form" partialSubmit="true"/>
						        	</p:droppable>
			        		</p:repeat>
			        		
							
			        	
			        		<!-- CONFIG MAPS -->
			        		<p:repeat var="configMap" value="#{viewInitializerBean.configMaps}" id="configmaps">
						        		<p:fieldset id="configmap" legend="ConfigMap #{configMap.configResourceID}" 						        					
						        					toggleable="true" toggleSpeed="500">
						        			<h:panelGrid columns="2">
						        				<p:commandButton  icon="fa fa-fw fa-chevron-right"
						        					actionListener="#{viewInitializerBean.moveSelectedKeysToCM(configMap.configResourceID)}" update="@form" />
						        				<h:panelGroup>
						        					<div>	
						        						<p:commandLink actionListener="#{viewInitializerBean.removeConfigMap(configMap.configResourceID)}" update="@form">
						        							<i class="fa fa-fw fa-remove" style="float:right" />
						        						</p:commandLink>
						        					</div>
									        		<h:panelGrid columns="2" style="margin-bottom:10px;">
								   						<h:outputText value="Name:"/>
														{AppName}<b>#{configMap.name}</b>
							   						</h:panelGrid>
								        			<p:outputPanel id="dropAreaCm_#{configMap.configResourceID}">
									        			<p:dataTable id="selectedForCm_#{configMap.configResourceID}" var="key" value="#{configMap.keyValue}">
									        				
									        				<p:column headerText="OCP Key">
											        			<h:outputText value="#{key.key}"/>
											        		</p:column>											        													        		
											        		<p:column width="15px;">
											        			<p:commandLink  action="#{viewInitializerBean.removeCmItem()}" 
											        			update="@form" immediate="true">
											        				<i class="fa fa-fw fa-remove"/>
											        				<f:setPropertyActionListener value="#{configMap.configResourceID}" target="#{viewInitializerBean.cmIdOfKeyToDelete}"/>
											        				<f:setPropertyActionListener value="#{key.key}" target="#{viewInitializerBean.cmItemKeyToDelete}"/>
											        			</p:commandLink>
											        		</p:column>
									        			</p:dataTable>
									        		</p:outputPanel>
									        	</h:panelGroup>
									        </h:panelGrid>
						        		</p:fieldset>		   
						        </p:repeat>     		
		        			<br/>
		        			<p:repeat var="configMap" value="#{viewInitializerBean.configMaps}" >
				        		<p:droppable for="configmaps:#{configMap.configResourceID}:configmap" tolerance="touch" datasource="datakeys" onDrop="handleDrop">
				        			<p:ajax listener="#{viewInitializerBean.onKeyDropToCm}" update="@form"/>
				        		</p:droppable>
		        			</p:repeat>
		        			
		        			<!-- SECRETS -->
		        			<p:repeat var="secret" value="#{viewInitializerBean.secrets}" id="secrets">
						        		<p:fieldset id="secret" legend="Secrets #{secret.configResourceID}" toggleable="true" toggleSpeed="500" >
						        			<h:panelGrid columns="2">
						        				<p:commandButton  icon="fa fa-fw fa-chevron-right"
						        					actionListener="#{viewInitializerBean.moveSelectedKeysToSecrets(secret.configResourceID)}" update="@form" />
						        				<h:panelGroup>
						        					<div>	
						        						<p:commandLink actionListener="#{viewInitializerBean.removeSecret(secret.configResourceID)}" update="@form">
						        							<i class="fa fa-fw fa-remove" style="float:right" />
						        						</p:commandLink>
						        					</div>
								        			<h:panelGrid columns="2" >
								   						<h:outputText value="Secret Name"/>
								   						{AppName}<b>#{secret.name}</b>
							   						</h:panelGrid>
								        			<p:outputPanel id="dropAreaSecret_#{secret.configResourceID}">
									        			<p:dataTable id="selectedForSecret_#{secret.configResourceID}" var="key" value="#{secret.keyValue}">
									        				
									        				<p:column headerText="OCP Key">
											        			<h:outputText value="#{key.key}"/>
											        		</p:column>											        													        		
											        		<p:column width="15px;">
											        			<i class="fa fa-fw fa-remove"/>
											        		</p:column>
									        			</p:dataTable>
									        		</p:outputPanel>
									        	</h:panelGroup>
									        </h:panelGrid>
								        </p:fieldset>
							</p:repeat>
			        		
			        		<p:repeat var="secret" value="#{viewInitializerBean.secrets}" >
				        		<p:droppable for="secrets:#{secret.configResourceID}:secret" tolerance="touch" datasource="datakeys" onDrop="handleDrop">
				        			<p:ajax listener="#{viewInitializerBean.onKeyDropToSecret}" update="@form"/>
				        		</p:droppable>
				        	</p:repeat>
		        		</td>
		        	</tr>
		        </table>
	        </p:outputPanel>
	        
	         <p:outputPanel id="mountCmSecrets" rendered="#{viewInitializerBean.activeIndex==2}">
	         	<table>
	         		<tr>
	         			<td>
	         				<p:repeat var="cmToMount" value="#{viewInitializerBean.configMaps}" id="cmForMount" >
		         				<p:panel toggleable="true" closable="true" toggleSpeed="500">
		         					<f:facet name="header" >
		         						Config Map [#{cmToMount.name}] values mount as env in Deployment
		         					</f:facet>
		         					<p:dataTable id="CmItem_#{cmToMount.configResourceID}" var="key"  value="#{cmToMount.selectedKeyValue}" 
		         						sortBy="#{key.keyName}">									        				
										
					        				<p:column  style="width:16px;text-align:center">	
							        			<p:selectBooleanCheckbox value="#{key.selected}"/>
											</p:column>
					        				<p:column headerText="Container ENV variable name" sortBy="#{key.keyName}">					        				
					        					<h:outputLabel value="#{key.keyName}" style="width:600px"/>					        								        			
							        		</p:column>
							        		<p:column headerText="Value [XLDeploy PlaceHolder is recommanded]">
							        			<p:inputText value="#{key.value}" style="width:600px" >
			        								<p:ajax event="change"   update="@form" immediate="true" />
			        							</p:inputText>		
							  						        			
							        		</p:column>
							        		<p:column headerText="Mount to Container" style="text-align:center;">
							        		
							        		<p:selectManyCheckbox id="basic" value="#{key.containers}">
       											<f:selectItems value="#{viewInitializerBean.containers}" var="container"
			        									itemLabel="#{container.name}" itemValue="#{container.name}"/>
        									</p:selectManyCheckbox>
			        												        			
							        		</p:column>							        	
					        		</p:dataTable>
		         				</p:panel>
	         				</p:repeat>
	         				<p:repeat var="secretToMount" value="#{viewInitializerBean.secrets}" id="secretsForMount">
		         				<p:panel toggleable="true" closable="false" toggleSpeed="500">
		         					<f:facet name="header" >
		         						Secret [#{secretToMount.name}] values mount as env in Deployment
		         					</f:facet>
		         					<p:dataTable id="CmItem_#{cmToMount.configResourceID}" var="key"  value="#{secretToMount.selectedKeyValue}" 
		         						sortBy="#{key.keyName}">									        				
										
					        				<p:column  style="width:16px;text-align:center">	
							        			<p:selectBooleanCheckbox value="#{key.selected}"/>
											</p:column>
					        				<p:column headerText="Container ENV variable name" sortBy="#{key.keyName}">					        				
					        					<h:outputLabel value="#{key.keyName}" style="width:600px"/>					        								        			
							        		</p:column>
							        		<p:column headerText="Value [XLDeploy PlaceHolder is recommanded]">
			        							<p:inputText value="#{key.value}" style="width:600px" >
			        							<p:ajax event="change"   update="@form" immediate="true" /></p:inputText>						        			
							        		</p:column>
							        		<p:column headerText="Mount to Container" style="text-align:center;">
			        							<p:selectManyCheckbox id="basic" value="#{key.containers}">
       											<f:selectItems value="#{viewInitializerBean.containers}" var="container"
			        									itemLabel="#{container.name}" itemValue="#{container.name}"/>
        									</p:selectManyCheckbox>								        			
							        		</p:column>							        	
					        		</p:dataTable>
		         				</p:panel>
	         				</p:repeat>
	         			</td>
	         			<td>
	         				
	         			</td>
	         		</tr>
	         	</table>
	         </p:outputPanel>
	         
	         <p:outputPanel id="createVolumes" rendered="#{viewInitializerBean.activeIndex==3}">	         
	         	<div style="position:relative;margin:auto;text-align:center;">
			    				    		
				    	<p:commandButton value="Add Volume"  actionListener="#{viewInitializerBean.addVolume}" update="@form" style="margin:10px;background:#003b50;color:white" />

				    	
			    </div>
			    
			    
	         	<p:repeat  value="#{viewInitializerBean.volumes}" var="vol">
	         		
	         		<p:panel style="width: 80em;position:relative;margin:auto;" id="panelVol">
					    
					    <f:facet name="header">
					       
					        <div>	Volume [#{vol.name}]
        						<p:commandLink actionListener="#{viewInitializerBean.removeVolume(vol.id)}" update="@form">
        							 <i class="fa fa-fw fa-remove" style="float:right" />
        						</p:commandLink>
						    </div>
					    </f:facet>				
						<h:panelGrid columns="3">
							<h:outputText value="Volume Name"/>
							<p:inputText value="#{vol.name}" >
								<p:ajax event="change" update="@form"/>
							</p:inputText>
							<p:spacer width="1"/>
							
							<h:outputText value="Type" />
							<p:selectOneMenu value="#{vol.type}" >
								<f:selectItem itemLabel="EmptyDir" itemValue="EmptyDir"/>
								<f:selectItem itemLabel="Persistent" itemValue="Persistent"/>
								<f:selectItem itemLabel="NAS" itemValue="NAS"/>
								<f:selectItem itemLabel="ConfigMap" itemValue="ConfigMap"/>
								<f:selectItem itemLabel="Secret" itemValue="Secret"/>
								<p:ajax event="change" update="@form" listener="#{viewInitializerBean.handleEvent(vol)}"/>
							</p:selectOneMenu>
							<p:spacer />
							
			
							<p:spacer rendered="#{vol.type=='NAS'}" width="1"/>
							<h:outputText value="Server" rendered="#{vol.type=='NAS'}"/>
							<p:selectOneMenu value="#{vol.nas.server}" rendered="#{vol.type=='NAS'}" editable="true" filter="true" filterMatchMode="contains">
								<f:selectItems value="#{viewInitializerBean.allKeys}" var="key" itemLabel="{{#{key}}}" itemValue="{{#{key}}}"/>		
								<p:ajax event="change" update="@form" />
							</p:selectOneMenu> 
							<p:spacer rendered="#{vol.type=='NAS'}" width="1"/>
							<h:outputText value="Server path" rendered="#{vol.type=='NAS'}"/>
							<p:selectOneMenu value="#{vol.nas.serverPath}" rendered="#{vol.type=='NAS'}" editable="true" filter="true" filterMatchMode="contains">
								<f:selectItems value="#{viewInitializerBean.allKeys}" var="key" itemLabel="{{#{key}}}" itemValue="{{#{key}}}"/>
								<p:ajax event="change" update="@form" />		
							</p:selectOneMenu> 
							
			
							<p:spacer rendered="#{vol.type=='Persistent'}" width="1"/>
							<h:outputText value="Claim name" rendered="#{vol.type=='Persistent'}"/>
							<p:inputText value="#{vol.claim.name}" rendered="#{vol.type=='Persistent'}">
								<p:ajax event="change" update="panelVol" ></p:ajax>		
							</p:inputText>
							
							<p:spacer rendered="#{vol.type=='Persistent'}" width="1"/>
							<h:outputText value="AccessModes" rendered="#{vol.type=='Persistent'}"/>
							<p:selectOneMenu  rendered="#{vol.type=='Persistent'}" value="#{vol.claim.accessModes}">
								<f:selectItem itemLabel="ReadWriteOnce" itemValue="ReadWriteOnce"/>
								<f:selectItem itemLabel="ReadOnlyMany" itemValue="ReadOnlyMany"/>
								<f:selectItem itemLabel="ReadWriteMany" itemValue="ReadWriteMany"/>	
								<p:ajax event="change" update="panelVol" ></p:ajax>						
							</p:selectOneMenu>
							
							<p:spacer rendered="#{vol.type=='Persistent'}" width="1"/>
							<h:outputText value="Storage" rendered="#{vol.type=='Persistent'}"/>
							<p:selectOneMenu  rendered="#{vol.type=='Persistent'}" value="#{vol.claim.gbStorage}">
								<f:selectItem itemLabel="1GB" itemValue="1"/>
								<f:selectItem itemLabel="2GB" itemValue="2"/>
								<f:selectItem itemLabel="3GB" itemValue="3"/>	
								<p:ajax event="change" update="panelVol" ></p:ajax>								
							</p:selectOneMenu>
							
							<p:spacer rendered="#{vol.type=='Persistent'}" width="1"/>
							<h:outputText value="StorageClass" rendered="#{vol.type=='Persistent'}"/>
							<p:selectOneMenu  rendered="#{vol.type=='Persistent'}" value="#{vol.claim.storageClassName}">
								<f:selectItem itemLabel="managed-nfs-storage" itemValue="managed-nfs-storage"/>
								<p:ajax event="change" update="panelVol" ></p:ajax>									
							</p:selectOneMenu>
							
							<p:spacer rendered="#{vol.type=='ConfigMap'}"/>
							<p:spacer rendered="#{vol.type=='ConfigMap'}"/>
							<h:outputText value="Drop the files you want to have as keys in the configmap :" rendered="#{vol.type=='ConfigMap'}"/>										

																																		
							<p:spacer rendered="#{vol.type=='ConfigMap'}"/>
							<p:spacer rendered="#{vol.type=='ConfigMap'}"/>
							<p:panel id="uploaderCm_#{vol.id}" rendered="#{vol.type=='ConfigMap'}">
								<p:fileUpload value="#{viewInitializerBean.fileForCm}" mode="advanced" dragDropSupport="true" multiple="true"
					   				rendered="#{vol.type=='ConfigMap'}" update="panelVol"
					   				listener="#{viewInitializerBean.addFileToCm}"></p:fileUpload>
							</p:panel>
							
							<p:spacer rendered="#{vol.type=='ConfigMap'}"/>
							<p:spacer rendered="#{vol.type=='ConfigMap'}"/>
							<p:dataTable value="#{vol.cmVol}" var="entry"  rendered="#{vol.type=='ConfigMap'}"> 
									<p:column  headerText="Key">	
							        		<h:outputText value="#{entry.key}"/>
									</p:column>
									<p:column  headerText="Value">	
							        		<h:outputText value="#{entry.key} Content"/>
									</p:column>
							</p:dataTable>
							
							<h:outputText value="Container"/>
							<p:selectOneMenu value="#{vol.container}" >
								<f:selectItems value="#{viewInitializerBean.containers}" var="cont" itemLabel="#{cont.name}" itemValue="#{cont.name}"/>							
							</p:selectOneMenu>
							<p:spacer/>
							
							<h:outputText value="Mount Path " rendered="#{vol.type!='ConfigMap'}"/>
							<h:outputText value="Vol Directory " rendered="#{vol.type=='ConfigMap'}"/>
							<p:selectOneMenu value="#{vol.path}" rendered="#{vol.type!='ConfigMap'}" editable="true" filter="true" filterMatchMode="contains">
								<f:selectItems value="#{viewInitializerBean.allKeys}" var="key" itemLabel="{{#{key}}}" itemValue="{{#{key}}}"/>		
								<p:ajax event="change" update="@form" listener="#{viewInitializerBean.addPathLog(vol)}"/>
							</p:selectOneMenu> 
							
							<p:selectOneMenu value="#{vol.path}" rendered="#{vol.type=='ConfigMap'}">
								<f:selectItem itemLabel="" itemValue="#{null}"/>
								<f:selectItems value="#{viewInitializerBean.pathVolMount}" var="item" itemLabel="#{item}" itemValue="#{item}"></f:selectItems>
								<p:ajax event="change" update="@form" listener="#{viewInitializerBean.handleVolPath(vol)}"/>
							</p:selectOneMenu>
							<p:spacer rendered="#{vol.type!='ConfigMap'}"/>
							<p:selectOneMenu value="#{vol.subPath}" rendered="#{vol.type=='ConfigMap'}" editable="true" filter="true" filterMatchMode="contains">
								<f:selectItems value="#{viewInitializerBean.allKeys}" var="key" itemLabel="{{#{key}}}" itemValue="{{#{key}}}"/>		
								<p:ajax event="change" update="@form" listener="#{viewInitializerBean.handleVolPath(vol)}"/>
							</p:selectOneMenu> 
							
														
						</h:panelGrid>
					</p:panel>
					
				</p:repeat>						
	         </p:outputPanel>
	         <center>
	         
	         <p:panel id="route" rendered="#{viewInitializerBean.activeIndex==4}" style="position:relative;margin:auto;" >
	         		         			
			    		Expose with a Route ?
			    		<p:selectBooleanButton  onLabel="Click to Unexpose" offLabel="Click to Expose"  style="background:#003b50;color:white;width:200px" 
			    		value="#{viewInitializerBean.routeExposed}" >
			    			<p:ajax event="change" update="route"/>
			    		</p:selectBooleanButton>
        				<br/>
        				
					<p:panel rendered="#{viewInitializerBean.routeExposed}" style="margin-top:40px;">
						<h:outputLabel value="https://{appName}-{appName}.{{ocp.environment}}.{{cluster-suffix}}" style="font-weight: bold;"/>												
					</p:panel>	    
						<p:spacer/>
						Run Pod with Specific User ? (mandatory for NAS)
			    		<p:selectBooleanButton  onLabel="Click to unmount User" offLabel="Click to runAsUser"  style="background:#003b50;color:white;width:300px" 
			    		value="#{viewInitializerBean.runAsUser}" >
			    			<p:ajax event="change" update="route"/>
			    		</p:selectBooleanButton>
					
					<p:panel rendered="#{viewInitializerBean.runAsUser}" style="margin-top:40px;">
					   <p:panelGrid columns="2">
							<h:outputText value="User (caxxxxx)" rendered="#{viewInitializerBean.runAsUser}"/>
							<p:selectOneMenu value="#{viewInitializerBean.user}" rendered="#{viewInitializerBean.runAsUser}" editable="true" filter="true" filterMatchMode="contains">
								<f:selectItems value="#{viewInitializerBean.allKeys}" var="key" itemLabel="{{#{key}}}" itemValue="{{#{key}}}"/>
								<p:ajax event="change" update="route" />		
							</p:selectOneMenu>
							
							<h:outputText value="User UID" rendered="#{viewInitializerBean.runAsUser}"/>
							<p:selectOneMenu value="#{viewInitializerBean.userUid}" rendered="#{viewInitializerBean.runAsUser}" editable="true" filter="true" filterMatchMode="contains">
								<f:selectItems value="#{viewInitializerBean.allKeys}" var="key" itemLabel="{{#{key}}}" itemValue="{{#{key}}}"/>
								<p:ajax event="change" update="route" />		
							</p:selectOneMenu>
							
							
							<h:outputText value="User GID" rendered="#{viewInitializerBean.runAsUser}"/>
							<p:selectOneMenu value="#{viewInitializerBean.userGid}" rendered="#{viewInitializerBean.runAsUser}" editable="true" filter="true" filterMatchMode="contains">
								<f:selectItems value="#{viewInitializerBean.allKeys}" var="key" itemLabel="{{#{key}}}" itemValue="{{#{key}}}"/>
								<p:ajax event="change" update="route" />		
							</p:selectOneMenu>
						</p:panelGrid>
					</p:panel>   	
	         </p:panel>
	         
	         <p:panel id="deployment" rendered="#{viewInitializerBean.activeIndex==5}" style="position:relative;margin:auto;" >
	         	<div style="position:relative;margin:auto;text-align:center;">
	         	<!-- 
			    		<p:selectBooleanButton  onLabel="Click to group Deployment all-in-one" offLabel="Click to split Deployment" 
			    		 style="background:#003b50;color:white;width:400px" 
			    		value="#{viewInitializerBean.splitDeployment}" >
			    			<p:ajax event="change" update="@form"/>
			    		</p:selectBooleanButton>
			    -->
				    	<p:commandButton value="Download the following Deployment-all.yml"  ajax="false" 
				    		rendered="#{!viewInitializerBean.splitDeployment}"
				    		onclick="PrimeFaces.monitorDownload(start, stop);" style="margin:10px;background:#003b50;color:white" >
				    		<p:fileDownload value="#{viewInitializerBean.fileDeployment}"/>
				    	</p:commandButton>
				    	
				    	<p:commandButton value="Download all resources in a Deployment.zip"  ajax="false" 
				    		rendered="#{viewInitializerBean.splitDeployment}"
				    		onclick="PrimeFaces.monitorDownload(start, stop);" style="margin:10px;background:#003b50;color:white" >
				    		<p:fileDownload value="#{viewInitializerBean.zipDeployment}"/>
				    	</p:commandButton>
				    					    	
				 
			    </div> 
			    
			    <p:tabView rendered="#{!viewInitializerBean.splitDeployment}">
			    	<p:tab title="#{viewInitializerBean.templateAllinOne.name}">
			    		<p:inputTextarea   value="#{viewInitializerBean.templateAllinOne.resourceAsString}" cols="100" rows="10" scrollHeight="200" />
			    	</p:tab>
			    	<p:tab title="#{viewInitializerBean.implementation_allInOne.name}">
			    		<p:inputTextarea   value="#{viewInitializerBean.implementation_allInOne.resourceAsString}" cols="100" rows="10" scrollHeight="200" />
			    	</p:tab>
			    </p:tabView>
			    
			    <p:tabView value="#{viewInitializerBean.generatedTemplatesResources}" var="resourceTemplate" rendered="#{viewInitializerBean.splitDeployment}">
			    	<p:tab title="#{resourceTemplate.name}">
			    		<p:inputTextarea   value="#{resourceTemplate.resourceAsString}" cols="100" rows="10" scrollHeight="200" />
			    	</p:tab>
			    </p:tabView>
	         		         		         
	         </p:panel>
	         </center>
	       
	         <p:dialog header="Report" widgetVar="dlgReportExecution" minHeight="500" width="1400" showEffect="fade" modal="true">	
					
					<h1>Congratulations ! Your project is created, configured and deployed. </h1>		
					<h:panelGrid columns="2" >
					
						<h:outputLabel value="Git Url :"/>
						<h:inputText value="#{viewInitializerBean.bootStrapResult.urlGitDev}" style="width:600px;" id="fgiturl"/>
						
						<h:outputLabel value="Deployer Url :"/>
						<h:inputText value="#{viewInitializerBean.bootStrapResult.urlPlaceHolder}" style="width:600px;" id="fplaceholderurl"/>
						
						<h:outputLabel value="CodeReady Workspace Url :"/>
						<h:inputText value="#{viewInitializerBean.bootStrapResult.urlCodeReady}" style="width:600px;" id="fcodereadyurl"/>
						
						<h:outputLabel value="OpenShift project Url :"/>
						<h:inputText value="#{viewInitializerBean.bootStrapResult.urlOpenShift}" style="width:600px;" id="focpurl"/>
					</h:panelGrid>					
															
			</p:dialog>
	          
    	</h:form>
	</p:panel>
	
		
	
	 <p:dialog header="Logs" widgetVar="dlgLog" minHeight="500" width="1400" showEffect="fade">	
	 		<h:form>			
					<h:outputText escape="false"  id="logapplication" value="#{pollView.listLogs}"/>
					<p:poll interval="2"  listener="#{pollView.increment}" update="logapplication"/>
			</h:form>																			
	 </p:dialog>
	  
        
    <p:dialog id="dlg1" header="#{dialogBean.header}" widgetVar="dlg1" minHeight="40" width="1200" showEffect="fade">
     	<p:scrollPanel style="width:1200px;height:600px">
	    <p:inputTextarea   value="#{dialogBean.content}" cols="100" rows="5"  />
	    </p:scrollPanel>
	</p:dialog>
	
	
 
 	<p:dialog  widgetVar="dlg0"  showEffect="fade">
		<h:form>
			<p:graphicImage name="loader_seq.gif"  style="background: transparent;"/>
			<center>.. In progress ..</center>
		</h:form>	
	</p:dialog>

</h:body>
</html>
